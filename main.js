(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r){var o=r.templateSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.cardName,this._link=e.cardLink,this._handleCardClick=n,this._templateSelector=o}var n,r;return n=t,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.firstElementChild.cloneNode(!0)}},{key:"_handleButtonLike",value:function(e){e.currentTarget.classList.toggle("elements__button-like_active")}},{key:"_handleButtonRemove",value:function(){this._newCard.remove(),this._newCard=null}},{key:"_setEventListeners",value:function(){var e=this;this._newCard.querySelector(".elements__button-like").addEventListener("click",(function(t){return e._handleButtonLike(t)})),this._newCard.querySelector(".elements__remove").addEventListener("click",(function(){return e._handleButtonRemove()})),this._cardImage.addEventListener("click",(function(){return e._handleCardClick(e._name,e._link)}))}},{key:"createNewCard",value:function(){return this._newCard=this._getTemplate(),this._cardImage=this._newCard.querySelector(".elements__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._newCard.querySelector(".elements__title").textContent=this._name,this._setEventListeners(),this._newCard}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._settingsForm=t,this._form=n,this._buttonElement=n.querySelector(t.submitButtonSelector),this._inputList=Array.from(n.querySelectorAll(t.inputSelector))}var t,r;return t=e,(r=[{key:"_handleFormSubmit",value:function(e){e.preventDefault()}},{key:"_toggleButtonState",value:function(){this._form.checkValidity()?(this._buttonElement.classList.remove(this._settingsForm.inactiveButtonClass),this._buttonElement.removeAttribute("disabled")):(this._buttonElement.classList.add(this._settingsForm.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0))}},{key:"_showInputError",value:function(e){this._errorElement=this._form.querySelector(".".concat(e.id,"-error")),e.classList.add(this._settingsForm.inputErrorClass),this._errorElement.textContent=e.validationMessage,this._errorElement.classList.add(this._settingsForm.errorClass)}},{key:"_hideInputError",value:function(e){this._errorElement=this._form.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._settingsForm.inputErrorClass),this._errorElement.classList.remove(this._settingsForm.errorClass),this._errorElement.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))})),this._form.addEventListener("submit",(function(t){return e._handleFormSubmit(t)}))}},{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){return e._hideInputError(t)}))}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._itemsArray=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(){var e=this;this._itemsArray.forEach((function(t){return e._renderer(t)}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._buttonClose=this._popup.querySelector(".popup__close"),this._handleEscClose=this._handleEscClose.bind(this),this._handleOverlayClose=this._handleOverlayClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&(e.preventDefault(),this.close())}},{key:"_handleOverlayClose",value:function(e){e.target.classList.contains("popup")&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._buttonClose.addEventListener("click",(function(){e.close()}))}},{key:"open",value:function(){document.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("mousedown",this._handleOverlayClose),this._popup.classList.add("popup_opened")}},{key:"close",value:function(){document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("mousedown",this._handleOverlayClose),this._popup.classList.remove("popup_opened")}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=p(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._handlerFormSubmit=t,n._form=n._popup.querySelector(".popup__form"),n._inputList=n._form.querySelectorAll(".popup__input"),n.inputValuesObj={},n}return t=a,(n=[{key:"_getInputValues",value:function(){var e=this;this._inputList.forEach((function(t){e.inputValuesObj[t.name]=t.value}))}},{key:"setInputValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"setEventListeners",value:function(){var e=this;l(h(a.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){e._getInputValues(),e._handlerFormSubmit(t)}))}},{key:"close",value:function(){l(h(a.prototype),"close",this).call(this),this._form.reset()}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=b(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function g(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._showCardImage=t._popup.querySelector(".popup__image"),t._showCardCaption=t._popup.querySelector(".popup__caption"),t}return t=a,(n=[{key:"open",value:function(e,t){this._showCardImage.src=t,this._showCardImage.alt=e,this._showCardCaption.textContent=e,v(E(a.prototype),"open",this).call(this)}}])&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t){var n=t.userNameSelector,r=t.userJobSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=document.querySelector(n),this._userJob=document.querySelector(r)}var t,n;return t=e,(n=[{key:"setUserInfo",value:function(e){var t=e.profileName,n=e.profileJob;this._userName.textContent=t,this._userJob.textContent=n}},{key:"getUserInfo",value:function(){return{profileName:this._userName.textContent,profileJob:this._userJob.textContent}}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),O={inputSelector:".popup__input",submitButtonSelector:".popup__save",inactiveButtonClass:"popup__save_inactive",inputErrorClass:"popup__input_status_error",errorClass:"popup__input-error_active"},L={userNameSelector:".profile__name",userJobSelector:".profile__description",cardListSelector:".elements__list",templateSelector:".template-elements",popupEditProfile:".popup_type_edit-profile",popupAddCard:".popup_type_add-card",popupShowCard:".popup_type_show-card"},j=document.querySelector(".profile__edit-button"),P=document.querySelector(".profile__add-button"),I=Array.from(document.forms),q={},R=new y(L.popupEditProfile,(function(e){e.preventDefault(),B.setUserInfo(this.inputValuesObj),R.close()}));R.setEventListeners();var x=new y(L.popupAddCard,(function(e){e.preventDefault();var n=new t(this.inputValuesObj,N.open.bind(N),L);V.addItem(n.createNewCard()),x.close()}));x.setEventListeners();var N=new k(L.popupShowCard);N.setEventListeners();var B=new S(L),V=new i({items:[{cardName:"Архыз",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{cardName:"Челябинская область",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{cardName:"Иваново",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{cardName:"Камчатка",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{cardName:"Холмогорский район",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{cardName:"Байкал",cardLink:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){var n=new t(e,N.open.bind(N),L);V.addItem(n.createNewCard())}},L.cardListSelector);I.forEach((function(e){var t=new r(O,e);t.enableValidation(),q[e.name]=t})),j.addEventListener("click",(function(){R.setInputValues(B.getUserInfo()),q.formEditProfile.resetValidation(),R.open()})),P.addEventListener("click",(function(){q.formAddCard.resetValidation(),x.open()})),V.renderItems()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3BhZ2VzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBoYW5kbGVDYXJkQ2xpY2ssIHt0ZW1wbGF0ZVNlbGVjdG9yfSkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLmNhcmROYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmNhcmRMaW5rO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gKGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnRcbiAgICAgIC5maXJzdEVsZW1lbnRDaGlsZFxuICAgICAgLmNsb25lTm9kZSh0cnVlKSk7XG4gIH1cblxuICBfaGFuZGxlQnV0dG9uTGlrZShldnQpIHtcbiAgICBldnQuY3VycmVudFRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50c19fYnV0dG9uLWxpa2VfYWN0aXZlJyk7XG4gIH1cblxuICBfaGFuZGxlQnV0dG9uUmVtb3ZlKCkge1xuICAgIHRoaXMuX25ld0NhcmQucmVtb3ZlKCk7XG4gICAgdGhpcy5fbmV3Q2FyZCA9IG51bGw7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbmV3Q2FyZFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19fYnV0dG9uLWxpa2UnKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4gdGhpcy5faGFuZGxlQnV0dG9uTGlrZShldnQpKTtcblxuICAgIHRoaXMuX25ld0NhcmRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHNfX3JlbW92ZScpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVCdXR0b25SZW1vdmUoKSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluaykpO1xuICB9XG5cbiAgY3JlYXRlTmV3Q2FyZCgpIHtcbiAgICB0aGlzLl9uZXdDYXJkID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9uZXdDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50c19faW1hZ2UnKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX25ld0NhcmQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRzX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fbmV3Q2FyZDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzRm9ybSwgZm9ybSkge1xuICAgIHRoaXMuX3NldHRpbmdzRm9ybSA9IHNldHRpbmdzRm9ybTtcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gZm9ybS5xdWVyeVNlbGVjdG9yKHNldHRpbmdzRm9ybS5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3NGb3JtLmlucHV0U2VsZWN0b3IpKTtcbiAgfVxuXG4gIF9oYW5kbGVGb3JtU3VibWl0KGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICghdGhpcy5fZm9ybS5jaGVja1ZhbGlkaXR5KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5nc0Zvcm0uaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzRm9ybS5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5nc0Zvcm0uaW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3NGb3JtLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzRm9ybS5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzRm9ybS5lcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIGVsc2VcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXRFbGVtZW50ID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoZXZ0KSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dEVsZW1lbnQgPT4gdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7aXRlbXMsIHJlbmRlcmVyfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtc0FycmF5ID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXNBcnJheS5mb3JFYWNoKGl0ZW0gPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fYnV0dG9uQ2xvc2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSA9IHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwJykpXG4gICAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9idXR0b25DbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlckZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVyRm9ybVN1Ym1pdCA9IGhhbmRsZXJGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9faW5wdXQnKTtcbiAgICB0aGlzLmlucHV0VmFsdWVzT2JqID0ge307XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaXRlbSA9PiB7XG4gICAgICB0aGlzLmlucHV0VmFsdWVzT2JqW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgIH0pXG4gIH1cblxuICBzZXRJbnB1dFZhbHVlcyhpbnB1dFZhbHVlcykge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaXRlbS52YWx1ZSA9IGlucHV0VmFsdWVzW2l0ZW0ubmFtZV07XG4gICAgfSlcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgICAgdGhpcy5faGFuZGxlckZvcm1TdWJtaXQoZXZ0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9zaG93Q2FyZEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuICAgIHRoaXMuX3Nob3dDYXJkQ2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgdGhpcy5fc2hvd0NhcmRJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX3Nob3dDYXJkSW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9zaG93Q2FyZENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7dXNlck5hbWVTZWxlY3RvciwgdXNlckpvYlNlbGVjdG9yfSkge1xuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl91c2VySm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iU2VsZWN0b3IpO1xuICB9XG5cbiAgc2V0VXNlckluZm8oe3Byb2ZpbGVOYW1lLCBwcm9maWxlSm9ifSkge1xuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gcHJvZmlsZU5hbWU7XG4gICAgdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudCA9IHByb2ZpbGVKb2I7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJvZmlsZU5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxuICAgICAgcHJvZmlsZUpvYjogdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudFxuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIGNhcmROYW1lOiAn0JDRgNGF0YvQtycsXG4gICAgY2FyZExpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvYXJraHl6LmpwZydcbiAgfSxcbiAge1xuICAgIGNhcmROYW1lOiAn0KfQtdC70Y/QsdC40L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjCcsXG4gICAgY2FyZExpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvY2hlbHlhYmluc2stb2JsYXN0LmpwZydcbiAgfSxcbiAge1xuICAgIGNhcmROYW1lOiAn0JjQstCw0L3QvtCy0L4nLFxuICAgIGNhcmRMaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xuICB9LFxuICB7XG4gICAgY2FyZE5hbWU6ICfQmtCw0LzRh9Cw0YLQutCwJyxcbiAgICBjYXJkTGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9rYW1jaGF0a2EuanBnJ1xuICB9LFxuICB7XG4gICAgY2FyZE5hbWU6ICfQpdC+0LvQvNC+0LPQvtGA0YHQutC40Lkg0YDQsNC50L7QvScsXG4gICAgY2FyZExpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2hvbG1vZ29yc2t5LXJheW9uLmpwZydcbiAgfSxcbiAge1xuICAgIGNhcmROYW1lOiAn0JHQsNC50LrQsNC7JyxcbiAgICBjYXJkTGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9iYWlrYWwuanBnJ1xuICB9XG5dO1xuXG5leHBvcnQgY29uc3Qgc2V0dGluZ3NGb3JtID0ge1xuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlJyxcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zYXZlX2luYWN0aXZlJyxcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3N0YXR1c19lcnJvcicsXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXQtZXJyb3JfYWN0aXZlJ1xufVxuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICB1c2VyTmFtZVNlbGVjdG9yOiAnLnByb2ZpbGVfX25hbWUnLFxuICB1c2VySm9iU2VsZWN0b3I6ICcucHJvZmlsZV9fZGVzY3JpcHRpb24nLFxuICBjYXJkTGlzdFNlbGVjdG9yOiAnLmVsZW1lbnRzX19saXN0JyxcbiAgdGVtcGxhdGVTZWxlY3RvcjogJy50ZW1wbGF0ZS1lbGVtZW50cycsXG4gIHBvcHVwRWRpdFByb2ZpbGU6ICcucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGUnLFxuICBwb3B1cEFkZENhcmQ6ICcucG9wdXBfdHlwZV9hZGQtY2FyZCcsXG4gIHBvcHVwU2hvd0NhcmQ6ICcucG9wdXBfdHlwZV9zaG93LWNhcmQnXG59XG5cbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xuZXhwb3J0IGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5mb3Jtcyk7XG4iLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICBzZXR0aW5nc0Zvcm0sXG4gIHNlbGVjdG9ycyxcbiAgZWRpdFByb2ZpbGVCdXR0b24sXG4gIGFkZENhcmRCdXR0b24sXG4gIGZvcm1MaXN0XG59IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzT2JqID0ge307XG5cbmNvbnN0IHBvcHVwRWRpdFByb2ZpbGUgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMucG9wdXBFZGl0UHJvZmlsZSwgaGFuZGxlclByb2ZpbGVTdWJtaXQpO1xucG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMucG9wdXBBZGRDYXJkLCBoYW5kbGVyQWRkQ2FyZFN1Ym1pdCk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBTaG93Q2FyZCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucG9wdXBTaG93Q2FyZCk7XG5wb3B1cFNob3dDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHNlbGVjdG9ycyk7XG5cbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcbiAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGl0ZW0sIHBvcHVwU2hvd0NhcmQub3Blbi5iaW5kKHBvcHVwU2hvd0NhcmQpLCBzZWxlY3RvcnMpO1xuICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmQuY3JlYXRlTmV3Q2FyZCgpKTtcbiAgfVxufSwgc2VsZWN0b3JzLmNhcmRMaXN0U2VsZWN0b3IpO1xuXG5mdW5jdGlvbiBoYW5kbGVyUHJvZmlsZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHRoaXMuaW5wdXRWYWx1ZXNPYmopO1xuICBwb3B1cEVkaXRQcm9maWxlLmNsb3NlKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZXJBZGRDYXJkU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHRoaXMuaW5wdXRWYWx1ZXNPYmosIHBvcHVwU2hvd0NhcmQub3Blbi5iaW5kKHBvcHVwU2hvd0NhcmQpLCBzZWxlY3RvcnMpO1xuICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkLmNyZWF0ZU5ld0NhcmQoKSk7XG4gIHBvcHVwQWRkQ2FyZC5jbG9zZSgpO1xufVxuXG5mb3JtTGlzdC5mb3JFYWNoKGZvcm0gPT4ge1xuICBjb25zdCBmb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3NGb3JtLCBmb3JtKTtcbiAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4gIGZvcm1WYWxpZGF0b3JzT2JqW2Zvcm0ubmFtZV0gPSBmb3JtVmFsaWRhdG9yO1xufSk7XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBwb3B1cEVkaXRQcm9maWxlLnNldElucHV0VmFsdWVzKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xuICBmb3JtVmFsaWRhdG9yc09iai5mb3JtRWRpdFByb2ZpbGUucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBvcHVwRWRpdFByb2ZpbGUub3BlbigpO1xufSk7XG5cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGZvcm1WYWxpZGF0b3JzT2JqLmZvcm1BZGRDYXJkLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwb3B1cEFkZENhcmQub3BlbigpO1xufSk7XG5cbmNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwidGVtcGxhdGVTZWxlY3RvciIsInRoaXMiLCJfbmFtZSIsImNhcmROYW1lIiwiX2xpbmsiLCJjYXJkTGluayIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfdGVtcGxhdGVTZWxlY3RvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsImV2dCIsImN1cnJlbnRUYXJnZXQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfbmV3Q2FyZCIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlQnV0dG9uTGlrZSIsIl9oYW5kbGVCdXR0b25SZW1vdmUiLCJfY2FyZEltYWdlIiwiX2dldFRlbXBsYXRlIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3NGb3JtIiwiZm9ybSIsIl9zZXR0aW5nc0Zvcm0iLCJfZm9ybSIsIl9idXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJwcmV2ZW50RGVmYXVsdCIsImNoZWNrVmFsaWRpdHkiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwicmVtb3ZlQXR0cmlidXRlIiwiYWRkIiwic2V0QXR0cmlidXRlIiwiaW5wdXRFbGVtZW50IiwiX2Vycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJlcnJvckNsYXNzIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zQXJyYXkiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZWxlbWVudCIsInByZXBlbmQiLCJpdGVtIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2J1dHRvbkNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVPdmVybGF5Q2xvc2UiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVyRm9ybVN1Ym1pdCIsIl9oYW5kbGVyRm9ybVN1Ym1pdCIsImlucHV0VmFsdWVzT2JqIiwibmFtZSIsInZhbHVlIiwiaW5wdXRWYWx1ZXMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlBvcHVwV2l0aEltYWdlIiwiX3Nob3dDYXJkSW1hZ2UiLCJfc2hvd0NhcmRDYXB0aW9uIiwibGluayIsIlVzZXJJbmZvIiwidXNlck5hbWVTZWxlY3RvciIsInVzZXJKb2JTZWxlY3RvciIsIl91c2VyTmFtZSIsIl91c2VySm9iIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlSm9iIiwic2VsZWN0b3JzIiwiY2FyZExpc3RTZWxlY3RvciIsInBvcHVwRWRpdFByb2ZpbGUiLCJwb3B1cEFkZENhcmQiLCJwb3B1cFNob3dDYXJkIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiZm9ybUxpc3QiLCJmb3JtcyIsImZvcm1WYWxpZGF0b3JzT2JqIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2FyZCIsIm9wZW4iLCJjYXJkc0xpc3QiLCJhZGRJdGVtIiwiY3JlYXRlTmV3Q2FyZCIsImZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwic2V0SW5wdXRWYWx1ZXMiLCJnZXRVc2VySW5mbyIsImZvcm1FZGl0UHJvZmlsZSIsInJlc2V0VmFsaWRhdGlvbiIsImZvcm1BZGRDYXJkIiwicmVuZGVySXRlbXMiXSwic291cmNlUm9vdCI6IiJ9